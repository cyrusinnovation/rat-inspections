<!doctype html>
<html>
	<head>
		<title>Rat Inspections</title>
		<link rel="stylesheet" href="http://cdn.leafletjs.com/leaflet-0.7.3/leaflet.css" />
		<style type="text/css" media="screen">
			#map {
				height: 800px;
			}	
		</style>
	</head>
	<body>
		<div id="map"></div>

		<script src="http://cdn.leafletjs.com/leaflet-0.7.3/leaflet.js"></script>
		<script src='//api.tiles.mapbox.com/mapbox.js/plugins/leaflet-omnivore/v0.2.0/leaflet-omnivore.min.js'></script>
		<script>
			var map = L.map('map').setView([40.74023, -73.96202], 12);
	    	var Stamen_TonerLite = L.tileLayer('http://{s}.tile.stamen.com/toner-lite/{z}/{x}/{y}.png', {
				attribution: 'Map tiles by <a href="http://stamen.com">Stamen Design</a>, <a href="http://creativecommons.org/licenses/by/3.0">CC BY 3.0</a> &mdash; Map data &copy; <a href="http://openstreetmap.org">OpenStreetMap</a> contributors, <a href="http://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>',
				subdomains: 'abcd',
				minZoom: 10,
				maxZoom: 20
			});
			Stamen_TonerLite.addTo(map);

			var colorScale = function (value) {
				if (value < 10)
					return '#ffeda0';
				else if (value < 20)
					return '#feb24c';
				else
					return '#f03b20';
			}

			var customLayer = L.geoJson(null, {
				// http://leafletjs.com/reference.html#geojson-style
				style: function(feature) {
					var feature_color = colorScale(feature.properties.ActiveCount);
					return {
						color: 'darkgray',
						fillColor: feature_color,
					    "weight": 1,
					    "opacity": 1,
					    fillOpacity: 0.75
					};
				},
				onEachFeature: function (feature, layer) {
					layer.bindPopup("<p>Active Count: "+feature.properties.ActiveCount+"</p>");
				}
			});

			omnivore.topojson('shapefiles/most_active.topojson',null,customLayer).addTo(map);

		</script>
	</body>
</html>